<form [formGroup]="form" class="edu-form">
  <div class="mb-5">
    <div class="flex align-items-center gap-2 mb-4">
      <h3 class="m-0 text-xl font-bold text-900">2 (i) Educational Information Entry</h3>
    </div>

    <div class="surface-50 border-round-2xl p-4">
      <!-- ID Input Section -->
      <div class="flex flex-wrap gap-3 mb-4">
        <div class="flex-1" style="min-width: 280px">
          <label class="font-semibold block mb-2 text-700">RAB ID</label>
          <input
            pInputText
            class="w-full"
            formControlName="rabId"
            placeholder="Enter RAB ID"
            (blur)="onIdBlur()"
          />
        </div>

        <div class="flex-1" style="min-width: 280px">
          <label class="font-semibold block mb-2 text-700">Service ID</label>
          <input
            pInputText
            class="w-full"
            formControlName="serviceId"
            placeholder="Enter Service ID"
            (blur)="onIdBlur()"
          />
        </div>
      </div>

      <div class="mb-4">
        <small class="text-600 block">
          <i class="pi pi-info-circle mr-1"></i>
          RAB ID/Service ID Input করলে নিচের তথ্য সমূহ Auto Load হবে | ***
        </small>
      </div>

      <p-divider></p-divider>

      <!-- Auto-loaded Information -->
      <div class="flex flex-wrap gap-3 mb-4">
        <div class="flex-1" style="min-width: 220px">
          <label class="font-semibold block mb-2 text-700">Name</label>
          <input
            pInputText
            class="w-full"
            formControlName="name"
            placeholder="Auto Load"
          />
        </div>

        <div class="flex-1" style="min-width: 220px">
          <label class="font-semibold block mb-2 text-700">Rank</label>
          <input
            pInputText
            class="w-full"
            formControlName="rank"
            placeholder="Auto Load"
          />
        </div>

        <div class="flex-1" style="min-width: 220px">
          <label class="font-semibold block mb-2 text-700">Corps</label>
          <input
            pInputText
            class="w-full"
            formControlName="corps"
            placeholder="Auto Load"
          />
        </div>

        <div class="flex-1" style="min-width: 220px">
          <label class="font-semibold block mb-2 text-700">Trade</label>
          <input
            pInputText
            class="w-full"
            formControlName="trade"
            placeholder="Auto Load"
          />
        </div>
      </div>

      <div class="flex flex-wrap gap-3 mb-4">
        <div class="flex-1" style="min-width: 280px">
          <label class="font-semibold block mb-2 text-700">Mother Organization</label>
          <input
            pInputText
            class="w-full"
            formControlName="motherOrganization"
            placeholder="Auto Load"
          />
        </div>

        <div class="flex-1" style="min-width: 280px">
          <label class="font-semibold block mb-2 text-700">Member Type</label>
          <input
            pInputText
            class="w-full"
            formControlName="memberType"
            placeholder="Auto Load"
          />
        </div>
      </div>

      <p-divider></p-divider>

      <!-- Educational Information Entry Fields -->
      <div class="mb-4">
        <h4 class="text-lg font-semibold text-900 mb-3">Educational Details</h4>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 100%">
            <label class="font-semibold block mb-2 text-700">Name of Exam/Degree</label>
            <p-select
              formControlName="examDegree"
              [options]="examDegreeList"
              optionLabel="label"
              optionValue="value"
              placeholder="Select from dropdown"
              styleClass="w-full"
            ></p-select>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 280px">
            <label class="font-semibold block mb-2 text-700">Institution Type</label>
            <p-select
              formControlName="institutionType"
              [options]="institutionTypeList"
              optionLabel="label"
              optionValue="value"
              placeholder="Select from dropdown"
              styleClass="w-full"
            ></p-select>
          </div>

          <div class="flex-1" style="min-width: 280px">
            <label class="font-semibold block mb-2 text-700">Institution Name</label>
            <p-select
              formControlName="institutionName"
              [options]="institutionNameList"
              optionLabel="label"
              optionValue="value"
              placeholder="Select from dropdown or manual entry"
              styleClass="w-full"
            ></p-select>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 100%">
            <label class="font-semibold block mb-2 text-700">Department/ Subject Name</label>
            <p-select
              formControlName="departmentSubjectName"
              [options]="departmentList"
              optionLabel="label"
              optionValue="value"
              placeholder="Select from dropdown or manual entry"
              styleClass="w-full"
            ></p-select>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 220px">
            <label class="font-semibold block mb-2 text-700">From</label>
            <p-datepicker
              formControlName="fromDate"
              placeholder="Select date"
              [showIcon]="true"
              dateFormat="dd-mm-yy"
              styleClass="w-full"
            ></p-datepicker>
          </div>

          <div class="flex-1" style="min-width: 220px">
            <label class="font-semibold block mb-2 text-700">To</label>
            <p-datepicker
              formControlName="toDate"
              placeholder="Select date"
              [showIcon]="true"
              dateFormat="dd-mm-yy"
              styleClass="w-full"
            ></p-datepicker>
          </div>

          <div class="flex-1" style="min-width: 220px">
            <label class="font-semibold block mb-2 text-700">Passing Year</label>
            <p-datepicker
              formControlName="passingYear"
              view="year"
              dateFormat="yy"
              placeholder="Select year"
              styleClass="w-full"
            ></p-datepicker>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 280px">
            <label class="font-semibold block mb-2 text-700">Grade</label>
            <p-select
              formControlName="grade"
              [options]="gradeList"
              optionLabel="label"
              optionValue="value"
              placeholder="Select from dropdown or manual entry"
              styleClass="w-full"
            ></p-select>
          </div>

          <div class="flex-1" style="min-width: 280px">
            <label class="font-semibold block mb-2 text-700">Grade Point (GPA / CGPA)</label>
            <input
              pInputText
              class="w-full"
              formControlName="gpaCgpa"
              placeholder="Enter GPA/CGPA"
            />
          </div>
        </div>

        <div class="mb-4">
          <label class="font-semibold block mb-2 text-700">Upload Certificate</label>
          <p-fileUpload
            mode="basic"
            name="certificate"
            chooseLabel="Choose File"
            [auto]="false"
            [customUpload]="true"
            (onSelect)="form.patchValue({ certificateFile: $event.files?.[0] })"
          ></p-fileUpload>
        </div>

        <div class="flex justify-content-end">
          <button
            pButton
            type="button"
            label="Save"
            icon="pi pi-check"
            class="p-button-primary"
            (click)="onSave()"
          ></button>
        </div>
      </div>

      <p-divider></p-divider>

      <!-- Educational History Table -->
      <div class="mb-3">
        <h4 class="text-lg font-semibold text-900 mb-3">Educational History</h4>

        <div class="surface-card border-round-lg overflow-hidden">
          <p-table
            [value]="educationList"
            styleClass="p-datatable-sm"
            responsiveLayout="scroll"
          >
            <ng-template pTemplate="header">
              <tr>
                <th style="width: 160px; background: var(--surface-100)">From</th>
                <th style="width: 160px; background: var(--surface-100)">To</th>
                <th style="background: var(--surface-100)">School/College/University</th>
                <th style="background: var(--surface-100)">Name of Exam/Degree</th>
                <th style="background: var(--surface-100)">Subjects/Departments</th>
                <th style="width: 160px; background: var(--surface-100)">Result</th>
                <th style="width: 140px; background: var(--surface-100)">Passing Year</th>
                <th style="background: var(--surface-100)">Remarks</th>
              </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row>
              <tr>
                <td>{{ row.from }}</td>
                <td>{{ row.to }}</td>
                <td>{{ row.institution }}</td>
                <td>{{ row.examDegree }}</td>
                <td>{{ row.subjectDepartment }}</td>
                <td>{{ row.result }}</td>
                <td>{{ row.passingYear }}</td>
                <td>{{ row.remarks }}</td>
              </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="8" class="text-center p-4 text-600">
                  <i class="pi pi-info-circle mr-2"></i>
                  No educational information found.
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </div>
  </div>
</form>