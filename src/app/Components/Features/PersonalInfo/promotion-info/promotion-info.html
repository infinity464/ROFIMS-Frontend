<form [formGroup]="form" class="mother-org-form">
  <div class="mb-5">
    <div class="flex align-items-center gap-2 mb-4">
      <h3 class="m-0 text-xl font-bold text-900">Promotion Information</h3>
    </div>

    <div class="surface-50 border-round-2xl p-4">
      <!-- ID Input Section -->
      <div class="flex flex-wrap gap-3 mb-4">
        <div class="flex-1" style="min-width: 280px">
          <label class="font-semibold block mb-2 text-700">RAB ID</label>
          <input
            pInputText
            class="w-full"
            formControlName="rabId"
            placeholder="Enter RAB ID"
            (blur)="onIdBlur()"
          />
        </div>

        <div class="flex-1" style="min-width: 280px">
          <label class="font-semibold block mb-2 text-700">Service ID</label>
          <input
            pInputText
            class="w-full"
            formControlName="serviceId"
            placeholder="Enter Service ID"
            (blur)="onIdBlur()"
          />
        </div>
      </div>

      <div class="mb-4">
        <small class="text-600 block">
          <i class="pi pi-info-circle mr-1"></i>
          RAB ID/Service ID Input করলে নিচের তথ্য সমূহ Auto Load হবে ***
        </small>
      </div>

      <p-divider></p-divider>

      <!-- Auto-loaded Information -->
      <div class="flex flex-wrap gap-3 mb-4">
        <div class="flex-1" style="min-width: 220px">
          <label class="font-semibold block mb-2 text-700">Name</label>
          <input
            pInputText
            class="w-full"
            formControlName="name"
            placeholder="Auto Load"
          />
        </div>

        <div class="flex-1" style="min-width: 220px">
          <label class="font-semibold block mb-2 text-700">Rank</label>
          <input
            pInputText
            class="w-full"
            formControlName="rank"
            placeholder="Auto Load"
          />
        </div>

        <div class="flex-1" style="min-width: 220px">
          <label class="font-semibold block mb-2 text-700">Corps</label>
          <input
            pInputText
            class="w-full"
            formControlName="corps"
            placeholder="Auto Load"
          />
        </div>

        <div class="flex-1" style="min-width: 220px">
          <label class="font-semibold block mb-2 text-700">Trade</label>
          <input
            pInputText
            class="w-full"
            formControlName="trade"
            placeholder="Auto Load"
          />
        </div>
      </div>

      <div class="flex flex-wrap gap-3 mb-4">
        <div class="flex-1" style="min-width: 280px">
          <label class="font-semibold block mb-2 text-700">Mother Organization</label>
          <input
            pInputText
            class="w-full"
            formControlName="motherOrganization"
            placeholder="Auto Load"
          />
        </div>

        <div class="flex-1" style="min-width: 280px">
          <label class="font-semibold block mb-2 text-700">Member Type</label>
          <input
            pInputText
            class="w-full"
            formControlName="memberType"
            placeholder="Auto Load"
          />
        </div>
      </div>

      <p-divider></p-divider>

      <!-- Service History Entry Fields -->
      <div class="mb-4">
        <h4 class="text-lg font-semibold text-900 mb-3">Service History Details</h4>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 100%">
            <label class="font-semibold block mb-2 text-700">
              Organization Unit Name <span class="text-red-500">*</span>
            </label>
            <p-select
              formControlName="organizationUnitNameId"
              [options]="unitNameList"
              optionLabel="label"
              optionValue="value"
              placeholder="Select from dropdown"
              styleClass="w-full"
            ></p-select>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 100%">
            <label class="font-semibold block mb-2 text-700">
              Organization Unit Location <span class="text-red-500">*</span>
            </label>
            <p-select
              formControlName="organizationUnitLocation"
              [options]="unitLocationList"
              optionLabel="label"
              optionValue="value"
              placeholder="Select from dropdown or manual entry"
              styleClass="w-full"
            ></p-select>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 280px">
            <label class="font-semibold block mb-2 text-700">From</label>
            <p-datepicker
              formControlName="fromDate"
              placeholder="Select date (Optional)"
              [showIcon]="true"
              dateFormat="dd-mm-yy"
              styleClass="w-full"
            ></p-datepicker>
          </div>

          <div class="flex-1" style="min-width: 280px">
            <label class="font-semibold block mb-2 text-700">To</label>
            <p-datepicker
              formControlName="toDate"
              placeholder="Select date (Optional)"
              [showIcon]="true"
              dateFormat="dd-mm-yy"
              styleClass="w-full"
            ></p-datepicker>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 100%">
            <label class="font-semibold block mb-2 text-700">Appointment</label>
            <p-select
              formControlName="appointment"
              [options]="appointmentList"
              optionLabel="label"
              optionValue="value"
              placeholder="Select from dropdown"
              styleClass="w-full"
            ></p-select>
          </div>
        </div>

        <div class="flex flex-wrap gap-3 mb-4">
          <div class="flex-1" style="min-width: 280px">
            <label class="font-semibold block mb-2 text-700">Auth</label>
            <input
              pInputText
              class="w-full"
              formControlName="auth"
              placeholder="Enter authorization details"
            />
          </div>

          <div class="flex-1" style="min-width: 280px">
            <label class="font-semibold block mb-2 text-700">Remarks</label>
            <input
              pInputText
              class="w-full"
              formControlName="remarks"
              placeholder="Enter remarks"
            />
          </div>
        </div>

        <div class="flex justify-content-end">
          <button
            pButton
            type="button"
            label="Save"
            icon="pi pi-check"
            class="p-button-primary"
            (click)="onSave()"
          ></button>
        </div>
      </div>

      <p-divider></p-divider>

      <!-- Service History List Table -->
      <div class="mb-3">
        <h4 class="text-lg font-semibold text-900 mb-3">Service History List</h4>

        <div class="surface-card border-round-lg overflow-hidden">
          <p-table
            [value]="serviceHistoryList"
            styleClass="p-datatable-sm"
            responsiveLayout="scroll"
          >
            <ng-template pTemplate="header">
              <tr>
                <th style="width: 80px; background: var(--surface-100)">Ser</th>
                <th style="background: var(--surface-100)">Unit Served</th>
                <th style="background: var(--surface-100)">Location</th>
                <th style="width: 180px; background: var(--surface-100)">From</th>
                <th style="width: 180px; background: var(--surface-100)">To</th>
                <th style="background: var(--surface-100)">Appointment</th>
                <th style="background: var(--surface-100)">Remarks</th>
              </tr>
            </ng-template>

            <ng-template pTemplate="body" let-row>
              <tr>
                <td class="text-center font-semibold">{{ row.ser }}</td>
                <td>{{ row.unitServed }}</td>
                <td>{{ row.location }}</td>
                <td>{{ row.from }}</td>
                <td>{{ row.to }}</td>
                <td>{{ row.appointment }}</td>
                <td>{{ row.remarks }}</td>
              </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="7" class="text-center p-4 text-600">
                  <i class="pi pi-info-circle mr-2"></i>
                  No service history found.
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </div>
  </div>
</form>