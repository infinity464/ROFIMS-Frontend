<p-fluid>
    <div class="card">
        <div class="font-semibold text-xl mb-5">Training Institute Setup</div>

        <form [formGroup]="trainingForm" (ngSubmit)="onSubmit()">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">

                <!-- Training Institute Name EN -->
                <div class="field">
                    <label for="trainingInstituteNameEN" class="block mb-2">
                        Name (English) <span class="text-red-500">*</span>
                    </label>
                    <input pInputText id="trainingInstituteNameEN" formControlName="trainingInstituteNameEN"
                        placeholder="Enter name (English)" class="w-full" />
                    @if (trainingForm.get('trainingInstituteNameEN')?.invalid &&
                    trainingForm.get('trainingInstituteNameEN')?.touched) {
                    <small class="text-red-500 block mt-1">
                        Name (English) is required
                    </small>
                    }
                </div>

                <!-- Training Institute Name BN -->
                <div class="field">
                    <label for="trainingInstituteNameBN" class="block mb-2">
                        Name (Bangla) <span class="text-red-500">*</span>
                    </label>
                    <input pInputText id="trainingInstituteNameBN" formControlName="trainingInstituteNameBN"
                        placeholder="Enter name (Bangla)" class="w-full" />
                    @if (trainingForm.get('trainingInstituteNameBN')?.invalid &&
                    trainingForm.get('trainingInstituteNameBN')?.touched) {
                    <small class="text-red-500 block mt-1">
                        Name (Bangla) is required
                    </small>
                    }
                </div>

                <!-- Country Id -->
                <div class="field">
                    <label for="countryId" class="block mb-2">
                        Country
                    </label>

                    <p-select [options]="country" optionLabel="codeValueEN" optionValue="codeId"
                        placeholder="Select Country" styleClass="w-full" formControlName="countryId">
                    </p-select>

                </div>

                <!-- Location -->
                <div class="field">
                    <label for="location" class="block mb-2">
                        Location
                    </label>
                    <input pInputText id="location" formControlName="location" placeholder="Enter location"
                        class="w-full" />
                </div>

            </div>

            <!-- Buttons -->
            <div class="flex justify-end gap-2">
                <p-button [label]="editingId ? 'Update' : 'Save'" type="submit"
                    [disabled]="trainingForm.invalid || isSubmitting">
                </p-button>

                <p-button label="Reset" icon="pi pi-refresh" severity="secondary" type="button" (onClick)="onReset()"
                    [disabled]="isSubmitting">
                </p-button>
            </div>
        </form>
    </div>
</p-fluid>

<div class="card mt-4">
    <div class="flex justify-between items-center flex-column sm:flex-row mb-4">
        <p-iconfield iconPosition="left" class="ml-auto">
            <p-inputicon>
                <i class="pi pi-search"></i>
            </p-inputicon>
            <input pInputText type="text" placeholder="Search institute" (input)="onSearch($event)" />
        </p-iconfield>
    </div>

    <p-table [value]="filteredInstitutes" [paginator]="true" [first]="first" [rows]="rows" [totalRecords]="totalRecords"
        [rowsPerPageOptions]="[10, 25, 50]">

        <ng-template pTemplate="header">
            <tr>
                <th style="width:5%">#</th>
                <th>Name (English)</th>
                <th>Name (Bangla)</th>
                <!-- <th>Country</th> -->
                <th>Location</th>
                <th style="width:15%">Action</th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-institute let-rowIndex="rowIndex">
            <tr>
                <td>{{ first + rowIndex + 1 }}</td>
                <td>{{ institute.trainingInstituteNameEN }}</td>
                <td>{{ institute.trainingInstituteNameBN || '-' }}</td>
                <!-- <td>{{ institute.countryId || '-' }}</td> -->
                <td>{{ institute.location || '-' }}</td>

                <td>
                    <div class="flex gap-2">
                        <button pButton icon="pi pi-pencil" (click)="onEdit(institute)">
                        </button>

                        <button pButton icon="pi pi-trash" class="p-button-danger"
                            (click)="onDelete(institute, $event)">
                        </button>
                    </div>
                </td>
            </tr>
        </ng-template>

    </p-table>
</div>
